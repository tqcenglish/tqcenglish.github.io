<!DOCTYPE html>
<html lang=zh-CN>
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="description" content="伐木掎矣，析薪杝矣">
  <meta name="keywords" content="">
  
    <link rel="icon" href="https://assets-cdn.github.com/favicon.ico">
  
    
  <title>羚羊挂角</title>
  <link rel="stylesheet" href="/style.css">
  <link rel="stylesheet" href="/lib/jquery.fancybox.min.css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <!-- Global Site Tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=GA_TRACKING_ID"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-47275396-1');
  </script>
</head>

<body>
  <header>
  <div class="header-container">
    <a class='logo' href="/">
      <span>羚羊挂角</span>
    </a>
    <ul class="right-header">
      
        <li class="nav-item">
          
            <a href="/" class="item-link">首页</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/about" class="item-link">关于</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/archives" class="item-link">归档</a>
          
        </li>
      
        <li class="nav-item">
          
            <a href="/tags" class="item-link">标签</a>
          
        </li>
      
    </ul>
  </div>
</header>

  <main id='post'>
  <div class="content">
    <article>
        <section class="content markdown-body">
          <h1>无标题</h1>
          <div class='post-meta'>
            <i class="fa fa-calendar" aria-hidden="true"></i> <time>2020年03月16日</time>
            
            
          </div>
          <h1 id="Asterisk-基础"><a href="#Asterisk-基础" class="headerlink" title="Asterisk 基础"></a>Asterisk 基础</h1><p>相关概念和配置</p>
<h3 id="关于接口"><a href="#关于接口" class="headerlink" title="关于接口"></a>关于接口</h3><p>Asterisk可以连接的接口类型:</p>
<ul>
<li>模拟接口(电话线,模拟电话)  <a href="#digital_analog_diff">常见模拟器接口和数字接口</a></li>
<li>数字线路(T1,E1)<a href="http://www.h3c.com.cn/Products___Technology/Technology/VoIP/Other_technology/Technology_recommend/200805/605894_30003_0.htm" target="_blank" rel="noopener">T1,E1介绍</a></li>
<li>Voip协议(SIP,IAX2)<a href="#word">名词解释</a></li>
</ul>
<h2 id="文件配置及对应功能设置"><a href="#文件配置及对应功能设置" class="headerlink" title="文件配置及对应功能设置"></a>文件配置及对应功能设置</h2><ul>
<li>extensions.conf 拨号方案文件</li>
<li>sip.conf Sip协议文件</li>
<li>iax.conf IAX通道文件</li>
</ul>
<h2 id="sip-conf"><a href="#sip-conf" class="headerlink" title="#sip.conf"></a>#sip.conf</h2><pre><code>srvlookup= yet | 建立一个逻辑和可解析地址的方法
record_out=Always | adhoc | Never ;去电录音Adhoc须要时,Never从不,Always总是
record_in=Never ;来电录音
callgroup ;呼叫组
type：sip的类型。格式：type =user|peer|friend
pickupgroup  ;代接组
disallow     ;不允许编码
allow        ;允许编码
port         ;端口号
qualify      ;监视Asterisk服务器与电话之间是否延时
host=dynamic ;要求号码要注册,以便Asterisk如何找到电话.(static则不需要注册)
</code></pre><h2 id="Asterisk-命令"><a href="#Asterisk-命令" class="headerlink" title="Asterisk 命令"></a>Asterisk 命令</h2><ul>
<li><p>sip</p>
<ul>
<li>sip set debug on  设置显示更多的sip信息</li>
<li>sip set debug off 关闭显示更多的sip信息</li>
<li>sip show channels 显示所有活动的SIP通道</li>
<li>sip show peers 显示所有已定义的SIP peer</li>
</ul>
</li>
<li><p>core</p>
<ul>
<li>core show applications 显示所有的应用，比如Dial, Radius, Hangup, Answer等</li>
<li>core show channels 显示所有的通话频道</li>
<li>core show codecs 显示所有支持的编解码器</li>
<li>core show functions 显示所有的功能函数</li>
<li>core stop gracefully 优雅地停止asterisk/</li>
<li>core stop now 立即停止运行asterisk</li>
</ul>
</li>
<li><p>module</p>
<ul>
<li>module show 显示所有已加载模块</li>
<li>module load cdr_radius.so     加载模块cdr_radius.so</li>
<li>module reload cdr_radius.so 重新加载模块cdr_radius.so</li>
<li>module unload cdr_radius.so 卸载模块cdr_radius.so</li>
</ul>
</li>
</ul>
<h3 id="application"><a href="#application" class="headerlink" title="application"></a>application</h3><ul>
<li>Echo()校验工作通道双向通讯</li>
</ul>
<h3 id="dialplan"><a href="#dialplan" class="headerlink" title="dialplan"></a>dialplan</h3><p>一般的原则是，拨号方案中的函数可以设置或者获取通道的原数据，但不能做信令或者媒体处理的事情</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li>Asterisk Quick Start Guide</li>
</ul>
<h2 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h2><p>概念解释</p>
<h3 id="常见模拟器接口和数字接口"><a href="#常见模拟器接口和数字接口" class="headerlink" title="常见模拟器接口和数字接口"></a>常见模拟器接口和数字接口</h3><ul>
<li><p>模拟接口</p>
<ul>
<li>射频</li>
<li>复合视频</li>
<li>端子</li>
</ul>
</li>
<li><p>数字接口</p>
<ul>
<li>VGA</li>
<li>DVI</li>
<li>HDMI</li>
<li>IEE1394</li>
<li>光纤</li>
</ul>
</li>
</ul>
<h3 id="名词解释"><a href="#名词解释" class="headerlink" title="名词解释"></a>名词解释</h3><ul>
<li>PSTN: Public Switched Telephone Network 公用交换电话网 <a href="http://zh.wikipedia.org/wiki/PSTN" target="_blank" rel="noopener">wiki</a></li>
<li>SIP: Session Initiation Protocol 会话发起协议 通常用于VOIP电话,进行呼叫建立,呼叫协商,呼叫结束.它帮助两个端互相通认,但它不处理媒体;当呼叫建立后,他通过实时传输协议(RTP)在电话A到电话B直接传输媒体.SIP是一个应用层的信令协议.他使用的端口是5060(通常)进行通信.SIP可以通过UDP和TCP传输层协议进行传输.RTP用于端点间传输媒体(语音),Asterisk中RTP使用大数字的无特权端口(默认10,000到20,000)<br>SIP优点:普通的被接受和结构灵活.其它的VOIP协议还有H.323,IAX,MGCP. <a href="http://zh.wikipedia.org/wiki/%E4%BC%9A%E8%AF%9D%E5%8F%91%E8%B5%B7%E5%8D%8F%E8%AE%AE" target="_blank" rel="noopener">wiki</a></li>
<li>IAX: Inter Aasterisk eXchange 协议通常用于服务器间通信,IAX和SIP协议最大区别在于媒体(语音)在端点之间传输的方式不同.Asterisk默认情况是在5060端口接收SIP信令,在10000-20000端口接收RTP(媒体)流.而IAX所有的信令和媒体流都通过一个端口4569进行传输.这种方式的好处是IAX协议能更适合在NAT相关拓扑的应用.IAX用户习惯对进入PBX系统的呼叫进行鉴权和处理.对从PBX系统呼出的呼叫,Asterisk应用IAX的iax.conf文件的端点进入(条目)对远端进行鉴权)</li>
<li>FXO, FXS 区别: FXO不生成拨号音,而是接收.FXS端口提供拨号音和震铃电压,在有呼叫的时候提醒用户.两者接口都提供双向通讯(同时双方向的通讯传输).如果Asterisk有个兼容FXO端口,就可以把电话线接入这端口,可以使用这根电话线呼叫和接收电话呼叫.同理,如果有个FXS端口,可以连接一部模拟电话,Asterisk就可以呼叫这部电话,可能也可以呼叫.(端口:通过配置使用的信令进行定义). FXS卡必须像中心局(CO)进行运转,使用FXO信令.同理,FXO卡连接CO,就意味着它需要像终端进行运转,使用FXS信令.</li>
</ul>
<h1 id="AsteriskWiki书签表"><a href="#AsteriskWiki书签表" class="headerlink" title="AsteriskWiki书签表"></a>AsteriskWiki书签表</h1><p>下面会列出Asterisk相关的知识点链接。</p>
<ul>
<li><a href="https://wiki.asterisk.org/wiki/display/AST/Getting+a+Backtrace" target="_blank" rel="noopener">Getting+a+Backtrace</a> 收集Asterisk错误堆栈信息, 才对官方提交bug时需要详细的堆栈信息。</li>
<li><a href="https://wiki.asterisk.org/wiki/display/AST/Secure+Calling+Tutorial" target="_blank" rel="noopener">Secure+Calling+Tutorial</a> 创建证书</li>
<li><a href="https://wiki.asterisk.org/wiki/display/AST/WebRTC+tutorial+using+SIPML5" target="_blank" rel="noopener">WebRTC+tutorial+using+SIPML5</a> 利用SIPML%建立WebRTC通话</li>
<li><a href="https://wiki.asterisk.org/wiki/display/AST/Asterisk+WebRTC+Support" target="_blank" rel="noopener">Asterisk+WebRTC+Support</a>Asterisk对WebRTC的支持情况和基本配置。</li>
<li><p><a href="https://wiki.asterisk.org/wiki/display/AST/Interactive+Connectivity+Establishment+%28ICE%29+in+Asterisk" target="_blank" rel="noopener">Interactive Connectivity Establishment (ICE) in Asterisk</a> Asterisk 关于ICE的设置。</p>
</li>
<li><p><a href="https://wiki.asterisk.org/wiki/display/AST/Coding+Guidelines" target="_blank" rel="noopener">Coding+Guidelines</a>Asterisk源码编码规范</p>
</li>
<li><a href="https://wiki.asterisk.org/wiki/display/AST/Setting+up+PJSIP+Realtime" target="_blank" rel="noopener">This tutorial describes the configuration of Asterisk’s PJSIP channel driver with the “realtime” database storage backend</a> Asterisk 设置PJSIP</li>
<li><a href="https://wiki.asterisk.org/wiki/display/AST/Asterisk+PJSIP+Troubleshooting+Guide" target="_blank" rel="noopener">Asterisk+PJSIP+Troubleshooting+Guide</a></li>
<li><p><a href="https://wiki.asterisk.org/wiki/display/AST/Migrating+from+chan_sip+to+res_pjsip" target="_blank" rel="noopener">Migrating from chan_sip to res_pjsip Skip to end of metadata</a></p>
</li>
<li><p><a href="https://wiki.asterisk.org/wiki/display/AST/PJSIP+Transport+Selection" target="_blank" rel="noopener">PJSIP+Transport+Selection</a></p>
</li>
<li><p><a href="https://wiki.asterisk.org/wiki/display/AST/Configuring+res_pjsip" target="_blank" rel="noopener">Configuring+res_pjsip</a></p>
</li>
</ul>
<h2 id="Asterisk相关协议"><a href="#Asterisk相关协议" class="headerlink" title="Asterisk相关协议"></a>Asterisk相关协议</h2><ul>
<li><a href="http://www.h3c.com.cn/Products___Technology/Technology/VoIP/Other_technology/Technology_recommend/200805/605897_30003_0.htm" target="_blank" rel="noopener">SIP技术介绍</a></li>
<li><a href="http://www.h3c.com.cn/Products___Technology/Technology/VoIP/Other_technology/Technology_recommend/200805/605897_30003_0.htm" target="_blank" rel="noopener">H.323技术介绍</a></li>
<li><a href="http://www.h3c.com.cn/MiniSite/Technology_Circle/Net_Reptile/The_Five/Home/Catalog/201206/747038_97665_0.htm" target="_blank" rel="noopener">STUN和TURN技术浅析</a></li>
</ul>

        </section>
    </article>
    
        
  </div>
  <aside>
    
    <div class="toc-container">
        <h1>目录</h1>
        <div class="content">
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Asterisk-基础"><span class="toc-number">1.</span> <span class="toc-text">Asterisk 基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#关于接口"><span class="toc-number">1.0.1.</span> <span class="toc-text">关于接口</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件配置及对应功能设置"><span class="toc-number">1.1.</span> <span class="toc-text">文件配置及对应功能设置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sip-conf"><span class="toc-number">1.2.</span> <span class="toc-text">#sip.conf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Asterisk-命令"><span class="toc-number">1.3.</span> <span class="toc-text">Asterisk 命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#application"><span class="toc-number">1.3.1.</span> <span class="toc-text">application</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dialplan"><span class="toc-number">1.3.2.</span> <span class="toc-text">dialplan</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考资料"><span class="toc-number">1.4.</span> <span class="toc-text">参考资料</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#注解"><span class="toc-number">1.5.</span> <span class="toc-text">注解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#常见模拟器接口和数字接口"><span class="toc-number">1.5.1.</span> <span class="toc-text">常见模拟器接口和数字接口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#名词解释"><span class="toc-number">1.5.2.</span> <span class="toc-text">名词解释</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AsteriskWiki书签表"><span class="toc-number">2.</span> <span class="toc-text">AsteriskWiki书签表</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Asterisk相关协议"><span class="toc-number">2.1.</span> <span class="toc-text">Asterisk相关协议</span></a></li></ol></li></ol>
        </div>
    </div>
    
  </aside>
</main>



  <footer>
  <div class="copyright">
    <div>
      &copy; 2020 | Powered by <a href="https://hexo.io" target="_blank">Hexo</a>&nbsp
    </div>
    <div>
      Theme by <a href="https://github.com/tqcenglish/hexo-theme-clean" target="_blank">clean</a>
    </div>
  </div>
</footer>


<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="/lib/in-view.min.js"></script>
<script src="/lib/lodash.min.js"></script>
<script>
  var isDown = true
  var oldY = 0
  inView.offset(50)

  document.body.addEventListener('touchstart', function(){});
  
  window.addEventListener('scroll', _.throttle(e => {
    var currentY = window.scrollY
    if((oldY - currentY) < 0) {
      isDown = true
    } else {
      isDown = false
    }
    oldY = currentY
  }, 250))

  $("article img").each(function() {
      var strA = "<a data-fancybox='gallery' href='" + this.src + "'></a>";
      $(this).wrapAll(strA);
  });

  $('.toc-link').each(function() {
      var href = $(this).attr("href");
      
      inView(href).on('exit', () => {
        if (isDown) {
          handleActive(href)
        }
      })

      inView(href).on('enter', () => {
        if (!isDown) {
          handleActive(href)
        }
      })

      this.onclick = function(e) {
        var pos = $(href).offset().top - 10;
        $("html,body").animate({scrollTop: pos}, 300);
        setTimeout(() => {
          handleActive(href)
        }, 350)
        return false
      }
  })

  function handleActive(href) {
    document.querySelectorAll('.toc-link').forEach(elm => {
      elm.classList.remove('active')
    })
    document.querySelector(".toc [href='"+ href +"']").classList.add('active')
  }
</script>
<script src="/lib/jquery.fancybox.min.js"></script>


</body>
</html>
